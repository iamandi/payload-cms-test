"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const validationPromise = async ({ errors, hook, newData, existingData, field, path, }) => {
    if (hook !== 'beforeChange')
        return true;
    const hasCondition = field.admin && field.admin.condition;
    const shouldValidate = field.validate && !hasCondition;
    let valueToValidate = newData[field.name];
    if (valueToValidate === undefined)
        valueToValidate = existingData[field.name];
    if (valueToValidate === undefined)
        valueToValidate = field.defaultValue;
    const result = shouldValidate ? await field.validate(valueToValidate, field) : true;
    if (typeof result === 'string') {
        errors.push({
            message: result,
            field: `${path}${field.name}`,
        });
    }
    return result;
};
exports.default = validationPromise;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmFsaWRhdGlvblByb21pc2UuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvZmllbGRzL3ZhbGlkYXRpb25Qcm9taXNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBV0EsTUFBTSxpQkFBaUIsR0FBRyxLQUFLLEVBQUUsRUFDL0IsTUFBTSxFQUNOLElBQUksRUFDSixPQUFPLEVBQ1AsWUFBWSxFQUNaLEtBQUssRUFDTCxJQUFJLEdBQ00sRUFBNkIsRUFBRTtJQUN6QyxJQUFJLElBQUksS0FBSyxjQUFjO1FBQUUsT0FBTyxJQUFJLENBQUM7SUFFekMsTUFBTSxZQUFZLEdBQUcsS0FBSyxDQUFDLEtBQUssSUFBSSxLQUFLLENBQUMsS0FBSyxDQUFDLFNBQVMsQ0FBQztJQUMxRCxNQUFNLGNBQWMsR0FBRyxLQUFLLENBQUMsUUFBUSxJQUFJLENBQUMsWUFBWSxDQUFDO0lBRXZELElBQUksZUFBZSxHQUFHLE9BQU8sQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDMUMsSUFBSSxlQUFlLEtBQUssU0FBUztRQUFFLGVBQWUsR0FBRyxZQUFZLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQzlFLElBQUksZUFBZSxLQUFLLFNBQVM7UUFBRSxlQUFlLEdBQUcsS0FBSyxDQUFDLFlBQVksQ0FBQztJQUV4RSxNQUFNLE1BQU0sR0FBRyxjQUFjLENBQUMsQ0FBQyxDQUFDLE1BQU0sS0FBSyxDQUFDLFFBQVEsQ0FBQyxlQUFlLEVBQUUsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQztJQUVwRixJQUFJLE9BQU8sTUFBTSxLQUFLLFFBQVEsRUFBRTtRQUM5QixNQUFNLENBQUMsSUFBSSxDQUFDO1lBQ1YsT0FBTyxFQUFFLE1BQU07WUFDZixLQUFLLEVBQUUsR0FBRyxJQUFJLEdBQUcsS0FBSyxDQUFDLElBQUksRUFBRTtTQUM5QixDQUFDLENBQUM7S0FDSjtJQUVELE9BQU8sTUFBTSxDQUFDO0FBQ2hCLENBQUMsQ0FBQztBQUVGLGtCQUFlLGlCQUFpQixDQUFDIn0=